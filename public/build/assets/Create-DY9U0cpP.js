import{r as h,u as E,j as e,L as k,a as I}from"./app-Bus1Jjcg.js";import{L as q,S as D,A as d}from"./AnimatedSection-Z1haEjeg.js";const B=["Sunny","Partly Cloudy","Cloudy","Light Rain","Heavy Rain","Windy","Hot","Cold"],O=["Mason","Carpenter","Electrician","Plumber","Laborer","Foreman","Engineer","Welder","Painter","Other"],P=["bags","tons","kg","cubic meters","cubic feet","pieces","liters","gallons","meters","feet","sheets","bundles","rolls"];function F({meta:_,project:j}){const[c,b]=h.useState([{worker_name:"",role:"",hours_worked:"",tasks_performed:""}]),[m,g]=h.useState([{material_name:"",quantity:"",unit:"bags",unit_cost:"",supplier:"",notes:""}]),[p,N]=h.useState([]),[w,y]=h.useState(!1),u=h.useRef(null),{data:n,setData:o,errors:v}=E({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",work_description:"",difficulties:"",weather_conditions:"",safety_notes:"",additional_notes:"",workers:[],materials:[]}),C=()=>{b([...c,{worker_name:"",role:"",hours_worked:"",tasks_performed:""}])},L=s=>{b(c.filter((a,t)=>t!==s))},f=(s,a,t)=>{const r=[...c];r[s][a]=t,b(r)},W=()=>{g([...m,{material_name:"",quantity:"",unit:"bags",unit_cost:"",supplier:"",notes:""}])},S=s=>{g(m.filter((a,t)=>t!==s))},x=(s,a,t)=>{const r=[...m];r[s][a]=t,g(r)},M=s=>{const a=s.target.files;if(!a)return;const t=[];Array.from(a).forEach(r=>{r.type.startsWith("image/")&&t.push({file:r,preview:URL.createObjectURL(r),caption:""})}),N([...p,...t]),u.current&&(u.current.value="")},$=s=>{const a=[...p];URL.revokeObjectURL(a[s].preview),a.splice(s,1),N(a)},R=(s,a)=>{const t=[...p];t[s].caption=a,N(t)},A=s=>{s.preventDefault();const a=c.filter(l=>l.worker_name.trim()),t=m.filter(l=>l.material_name.trim()),r=new FormData;r.append("work_date",n.work_date),r.append("start_time",n.start_time),r.append("end_time",n.end_time),r.append("work_description",n.work_description),r.append("difficulties",n.difficulties),r.append("weather_conditions",n.weather_conditions),r.append("safety_notes",n.safety_notes),r.append("additional_notes",n.additional_notes),a.forEach((l,i)=>{r.append(`workers[${i}][worker_name]`,l.worker_name),r.append(`workers[${i}][role]`,l.role),r.append(`workers[${i}][hours_worked]`,l.hours_worked),r.append(`workers[${i}][tasks_performed]`,l.tasks_performed)}),t.forEach((l,i)=>{r.append(`materials[${i}][material_name]`,l.material_name),r.append(`materials[${i}][quantity]`,l.quantity),r.append(`materials[${i}][unit]`,l.unit),r.append(`materials[${i}][unit_cost]`,l.unit_cost),r.append(`materials[${i}][supplier]`,l.supplier),r.append(`materials[${i}][notes]`,l.notes)}),p.forEach((l,i)=>{r.append(`images[${i}]`,l.file),r.append(`captions[${i}]`,l.caption)}),y(!0),I.post(`/site-work/project/${j.id}`,r,{onFinish:()=>y(!1)})};return e.jsxs(q,{children:[e.jsx(D,{meta:_}),e.jsxs("section",{className:"relative pt-36 pb-12 md:pt-44 md:pb-16 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-brand-950"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top,rgba(245,158,11,0.08),transparent_60%)]"}),e.jsx("div",{className:"relative container-custom",children:e.jsxs(d,{variant:"fade-up",children:[e.jsxs(k,{href:`/site-work/project/${j.id}`,className:"inline-flex items-center gap-2 text-gray-400 hover:text-accent transition-colors mb-6",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to ",j.title]}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-display font-bold text-white",children:"New Work Log"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Record today's site work activities"})]})})]}),e.jsx("section",{className:"py-12 md:py-16 bg-brand-950",children:e.jsx("div",{className:"container-custom max-w-4xl",children:e.jsxs("form",{onSubmit:A,className:"space-y-8",children:[e.jsx(d,{variant:"fade-up",children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white mb-6",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Date *"}),e.jsx("input",{type:"date",value:n.work_date,onChange:s=>o("work_date",s.target.value),className:"input-modern w-full",required:!0}),v.work_date&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:v.work_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Weather"}),e.jsxs("select",{value:n.weather_conditions,onChange:s=>o("weather_conditions",s.target.value),className:"input-modern w-full",children:[e.jsx("option",{value:"",children:"Select weather..."}),B.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Start Time"}),e.jsx("input",{type:"time",value:n.start_time,onChange:s=>o("start_time",s.target.value),className:"input-modern w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"End Time"}),e.jsx("input",{type:"time",value:n.end_time,onChange:s=>o("end_time",s.target.value),className:"input-modern w-full"})]})]})]})}),e.jsx(d,{variant:"fade-up",delay:100,children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white mb-6",children:"Work Description *"}),e.jsx("textarea",{value:n.work_description,onChange:s=>o("work_description",s.target.value),rows:5,className:"input-modern w-full",placeholder:"Describe what was done today...",required:!0}),v.work_description&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:v.work_description})]})}),e.jsx(d,{variant:"fade-up",delay:150,children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white",children:"Workers"}),e.jsx("button",{type:"button",onClick:C,className:"btn-secondary text-sm",children:"+ Add Worker"})]}),e.jsx("div",{className:"space-y-4",children:c.map((s,a)=>e.jsxs("div",{className:"p-4 bg-brand-900/50 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Worker ",a+1]}),c.length>1&&e.jsx("button",{type:"button",onClick:()=>L(a),className:"text-red-400 hover:text-red-300 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Name"}),e.jsx("input",{type:"text",value:s.worker_name,onChange:t=>f(a,"worker_name",t.target.value),className:"input-modern w-full text-sm",placeholder:"Worker name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Role"}),e.jsxs("select",{value:s.role,onChange:t=>f(a,"role",t.target.value),className:"input-modern w-full text-sm",children:[e.jsx("option",{value:"",children:"Select role..."}),O.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Hours"}),e.jsx("input",{type:"number",step:"0.5",min:"0",value:s.hours_worked,onChange:t=>f(a,"hours_worked",t.target.value),className:"input-modern w-full text-sm",placeholder:"8"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Tasks"}),e.jsx("input",{type:"text",value:s.tasks_performed,onChange:t=>f(a,"tasks_performed",t.target.value),className:"input-modern w-full text-sm",placeholder:"Tasks performed"})]})]})]},a))})]})}),e.jsx(d,{variant:"fade-up",delay:200,children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white",children:"Materials Used"}),e.jsx("button",{type:"button",onClick:W,className:"btn-secondary text-sm",children:"+ Add Material"})]}),e.jsx("div",{className:"space-y-4",children:m.map((s,a)=>e.jsxs("div",{className:"p-4 bg-brand-900/50 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-400",children:["Material ",a+1]}),m.length>1&&e.jsx("button",{type:"button",onClick:()=>S(a),className:"text-red-400 hover:text-red-300 text-sm",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label-modern text-xs",children:"Material"}),e.jsx("input",{type:"text",value:s.material_name,onChange:t=>x(a,"material_name",t.target.value),className:"input-modern w-full text-sm",placeholder:"e.g., Cement"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Quantity"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.quantity,onChange:t=>x(a,"quantity",t.target.value),className:"input-modern w-full text-sm",placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Unit"}),e.jsx("select",{value:s.unit,onChange:t=>x(a,"unit",t.target.value),className:"input-modern w-full text-sm",children:P.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Unit Cost"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.unit_cost,onChange:t=>x(a,"unit_cost",t.target.value),className:"input-modern w-full text-sm",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern text-xs",children:"Supplier"}),e.jsx("input",{type:"text",value:s.supplier,onChange:t=>x(a,"supplier",t.target.value),className:"input-modern w-full text-sm",placeholder:"Supplier"})]})]})]},a))})]})}),e.jsx(d,{variant:"fade-up",delay:250,children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white mb-6",children:"Additional Information"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Difficulties Encountered"}),e.jsx("textarea",{value:n.difficulties,onChange:s=>o("difficulties",s.target.value),rows:3,className:"input-modern w-full",placeholder:"Any challenges or problems faced..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Safety Notes"}),e.jsx("textarea",{value:n.safety_notes,onChange:s=>o("safety_notes",s.target.value),rows:2,className:"input-modern w-full",placeholder:"Any safety concerns or incidents..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-modern",children:"Additional Notes"}),e.jsx("textarea",{value:n.additional_notes,onChange:s=>o("additional_notes",s.target.value),rows:2,className:"input-modern w-full",placeholder:"Any other relevant information..."})]})]})]})}),e.jsx(d,{variant:"fade-up",delay:275,children:e.jsxs("div",{className:"card-modern rounded-2xl p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-display font-semibold text-white",children:"Work Images"}),e.jsxs("button",{type:"button",onClick:()=>{var s;return(s=u.current)==null?void 0:s.click()},className:"btn-secondary text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Add Images"]}),e.jsx("input",{ref:u,type:"file",multiple:!0,accept:"image/*",onChange:M,className:"hidden"})]}),p.length===0?e.jsxs("div",{onClick:()=>{var s;return(s=u.current)==null?void 0:s.click()},className:"border-2 border-dashed border-brand-700/50 rounded-xl p-8 text-center cursor-pointer hover:border-accent/50 transition-colors",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-500 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-gray-400 mb-2",children:"Click to upload images of work done"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Supports JPEG, PNG, GIF, WebP (max 5MB each)"})]}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[p.map((s,a)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-brand-800",children:e.jsx("img",{src:s.preview,alt:`Preview ${a+1}`,className:"w-full h-full object-cover"})}),e.jsx("button",{type:"button",onClick:()=>$(a),className:"absolute top-2 right-2 p-1.5 bg-red-500 rounded-full text-white opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("input",{type:"text",value:s.caption,onChange:t=>R(a,t.target.value),className:"input-modern w-full text-sm mt-2",placeholder:"Caption (optional)"})]},a)),e.jsx("div",{onClick:()=>{var s;return(s=u.current)==null?void 0:s.click()},className:"aspect-square border-2 border-dashed border-brand-700/50 rounded-lg flex items-center justify-center cursor-pointer hover:border-accent/50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"w-8 h-8 mx-auto text-gray-500 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-gray-500 text-sm",children:"Add More"})]})})]})]})}),e.jsx(d,{variant:"fade-up",delay:300,children:e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e.jsx(k,{href:`/site-work/project/${j.id}`,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:w,className:"btn-primary",children:w?"Saving...":"Save Work Log"})]})})]})})})]})}export{F as default};
